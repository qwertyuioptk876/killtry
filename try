local rs = game:GetService("ReplicatedStorage")

-- éè¿´åˆ—å° table è³‡æ–™
local function dumpTable(t, indent)
    indent = indent or 0
    local prefix = string.rep("  ", indent)
    if type(t) ~= "table" then
        print(prefix .. tostring(t))
        return
    end
    for k, v in pairs(t) do
        if type(v) == "table" then
            print(prefix .. tostring(k) .. ":")
            dumpTable(v, indent + 1)
        else
            print(prefix .. tostring(k) .. ": " .. tostring(v))
        end
    end
end

-- ğŸ”¹ ç›£è½ä¾†è‡ªä¼ºæœå™¨çš„äº‹ä»¶
for _, v in ipairs(rs:GetDescendants()) do
    if v:IsA("RemoteEvent") then
        v.OnClientEvent:Connect(function(...)
            print("ğŸ“© ä¾†è‡ª Server çš„äº‹ä»¶ï¼š", v:GetFullName())
            local args = {...}
            for i, arg in ipairs(args) do
                print("   ğŸ”¹ åƒæ•¸ " .. i .. ":")
                dumpTable(arg)
            end
        end)
    end
end

-- ğŸ”¸ ç›£è½å®¢æˆ¶ç«¯å‚³é€çµ¦ä¼ºæœå™¨çš„ FireServer å‘¼å«ï¼ˆéœ€ Delta / Synapse æ”¯æ´ï¼‰
local mt = getrawmetatable(game)
setreadonly(mt, false)

local oldNamecall = mt.__namecall

mt.__namecall = newcclosure(function(self, ...)
    local args = {...}
    local method = getnamecallmethod()

    -- ğŸ” ç›£è½ FireServer å‘¼å«
    if method == "FireServer" and self:IsA("RemoteEvent") then
        print("ğŸš€ å®¢æˆ¶ç«¯ â†’ Server çš„äº‹ä»¶ï¼š", self:GetFullName())
        for i, arg in ipairs(args) do
            print("   ğŸ“¨ åƒæ•¸ " .. i .. ":")
            dumpTable(arg)
        end
    end

    return oldNamecall(self, ...)
end)

setreadonly(mt, true)

